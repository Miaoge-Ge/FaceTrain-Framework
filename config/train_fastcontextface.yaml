
model:
  backbone: fastcontextface
  embedding_size: 512
  pretrained: false

head:
  type: adaface
  num_classes: 85742
  margin: 0.5
  scale: 64.0

data:
  name: faces_emore
  root: /data/faces_emore
  batch_size: 256 # Revert to 256 to fit in memory
  num_workers: 8
  img_size: [112, 112]

training:
  epochs: 25
  optimizer: sgd # Revert to SGD for stability and memory efficiency
  lr: 0.1 # Standard SGD LR
  momentum: 0.9
  weight_decay: 4.0e-05 # Standard SGD weight decay
  scheduler: multistep
  milestones: [10, 16, 22]
  gamma: 0.1
  min_lr: 1.0e-05
  warmup_epochs: 1
  resume: false
  early_stop: false # Disable early stopping for full training
  # patience: 10 # Not needed
  monitor: val_accuracy
  mode: max
  min_delta: 0.001

checkpoint:
  save_dir: checkpoints/fastcontextface
  keep_last_n: 5

logging:
  log_dir: logs/fastcontextface
  print_freq: 100
  tensorboard: true

eval:
  dataset: "lfw"
  bin_file: "lfw.bin"
  test_batch_size: 64
  eval_freq: 1
